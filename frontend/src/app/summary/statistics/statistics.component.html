
<body class="bg-funky">
    <div class="min-h-screen p-6 ph-10p md:p-10" *ngIf="!data.no_data">
      <header class="mb-8">
        <div class="flex items-center justify-between">
          <div class="p-4 rounded-lg  m-auto">
            <img src="../../../assets/images/logo-transparent.png" class="w-full">
          </div>
          
        </div>

        <div class="calendar-modal">
          <div class="modal-backdrop" (click)="hideCalendar()"></div>
          <div class="modal-content">
            <p-calendar
              #calendar
              [(ngModel)]="dates"
              [readonlyInput]="true"
              [showButtonBar]="false"
              [inline]="true"
              [selectionMode]="'range'">
              <ng-template pTemplate="footer">
                <div class="calendar-footer">
                  <p-button
                    label="Anuluj"
                    class="calendar-button1"
                    (onClick)="hideCalendar()"
                  ></p-button>
                  <p-button
                    label="Zatwierdź"
                    class="calendar-button2"
                    (onClick)="selectSeason({name: 'custom', startValue: this.dates[0].getTime()/1000, endValue: this.dates[1].getTime()/1000})"
                  ></p-button>
                </div>
              </ng-template>
            </p-calendar>
          </div>
        </div>
      </header>
  
      <main>
        <div style="padding-bottom: 4rem;">
        <span *ngIf="isOriginal()" class="text-1">Hej {{data.name}}, dobrze Cię widzieć!</span>
        <span *ngIf="!isOriginal()" class="text-1">Podsumowanie użytkownika {{data.name}}</span>

        </div>
        <div>
          
          <p *ngIf="season.name !== 'custom'" style="font-size: x-large;">
            Oto <span *ngIf="isOriginal()">twoje </span>podsumowanie sezonu <span style="font-weight: bold;">{{season.name}}</span>. Wybierz <a style="font-weight: bold; cursor: pointer;" (click)="showCalendar()">inny przedział czasu</a>
          </p>
          <p *ngIf="season.name === 'custom' && isOriginal()" style="font-size: x-large;">
            Oto <span *ngIf="isOriginal()">twoje </span>podsumowanie dni <span style="font-weight: bold;">{{ formatDate(season.startValue) }} - {{ formatDate(season.endValue) }}</span>. Wybierz <a style="font-weight: bold; cursor: pointer;" (click)="showCalendar()">inny przedział czasu</a>.
          </p>

  
          <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="bg-white p-6 rounded-lg shadow-md">
              <h2 class="text-2xl font-bold mb-2"><p pTooltip="Dystans liczony według najkrótszych tras między stacjami według Map Google">Total Mileage <i class="pi pi-question-circle"></i></p></h2>
              <p class="text-4xl font-bold"  >{{ (data.total_distance / 1000).toFixed(1) }} km</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-md">
              <h2 class="text-2xl font-bold mb-2">Total Spending</h2>
              <p class="text-4xl font-bold">{{ data.total_cost }} zł</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-md">
              <h2 class="text-2xl font-bold mb-2">Total Time</h2>
              <p class="text-4xl font-bold">{{floor(data.total_time / 60) }} h, {{ (data.total_time % 60).toFixed(0) }} min</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-md">
              <h2 class="text-2xl font-bold mb-2">Total Rents</h2>
              <p class="text-4xl font-bold">{{ data.total_rides }}</p>
            </div>
          </div>
  
          <div class="bg-white p-6 rounded-lg shadow-md mb-8">
            <h2 class="text-2xl font-bold mb-4">Longest Ride</h2>
            <div class="flex items-center justify-between">
              <div>
                <p class="text-lg font-semibold">{{data.longest_ride.start_place}}</p>
                <p class="text-lg font-semibold">{{data.longest_ride.end_place}}</p>
              </div>
              <div class="dada">
                <img src="assets/images/startstop.png" alt="start stop" class="h-16">
                </div>

              <div>
                <p class="text-4xl font-bold">{{(data.longest_ride.distance / 1000).toFixed(1)}} km</p>
                <p class="text-4xl font-bold">{{(data.longest_ride.time / 60).toFixed(0)}} min</p>
              </div>
            </div>
          </div>
  
          <div class="bg-white p-6 rounded-lg shadow-md mb-8">
            <h2 class="text-2xl font-bold mb-4">Top Rides</h2>
            <div class="space-y-4 ">
              <div class="flex items-center justify-between bg-neutral-100 p-4 rounded-md  ride-top3 mb-2" *ngFor="let ride of data.top_rides">
                <div>
                  <p class="font-semibold">{{ ride[0] }} - {{ ride[1] }}</p>
                  <p class="text-sm text-neutral-600">{{ ride[2] }} razy</p>
                </div>
              </div>
            </div>
          </div>
  
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-2xl font-bold mb-4">Your Ride Map</h2>
            <div class="bg-neutral-300 hwe rounded-md flex items-center justify-center overflow-hidden">
              <img [src]="data.map" alt="Mapa przejazdów" class="image" (click)="openModal()">
            </div>
          </div>

          <div id="imageModal" class="modal hidden" (click)="closeModal($event)">
            <img class="modal-content" id="modalImage">
          </div>


        </div>
      </main>
    </div>
  
    <div class="center-div" *ngIf="data.no_data">
      <div class="no-data">
        <span class="text-1">Nie jeździłeś w tym sezonie...</span>
        <span *ngIf="season.name!='custom'" class="text-2">Wsiadaj na rower albo wybierz inny sezon.</span>
        <span *ngIf="season.name==='custom'" class="text-2">Wsiadaj na rower albo wybierz inny przedział czasu.</span>
      </div>
    </div>
  </body>
  